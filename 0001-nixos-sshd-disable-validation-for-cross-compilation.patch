From e5c3364c7bf494fd46ddfb41ecae2b9718a141ac Mon Sep 17 00:00:00 2001
From: Samuel Dionne-Riel <samuel@dionne-riel.com>
Date: Sat, 8 Jun 2019 01:13:52 -0400
Subject: [PATCH] nixos/sshd: disable validation for cross-compilation

See: https://github.com/NixOS/nixpkgs/pull/62853

---
 nixos/modules/services/networking/ssh/sshd.nix | 1 +
 1 file changed, 1 insertion(+)

diff --git a/nixos/modules/services/networking/ssh/sshd.nix b/nixos/modules/services/networking/ssh/sshd.nix
index 89f56a726f4..c208aab992d 100644
--- a/nixos/modules/services/networking/ssh/sshd.nix
+++ b/nixos/modules/services/networking/ssh/sshd.nix
@@ -9,6 +9,7 @@ let
     ${cfg.extraConfig}
     EOL
 
+  '' + optionalString (pkgs.hostPlatform == pkgs.buildPlatform) ''
     ssh-keygen -f mock-hostkey -N ""
     sshd -t -f $out -h mock-hostkey
   '';
-- 
2.19.2

